# 高德地图工具使用说明

## 功能概述

本工具集成了高德地图API，提供以下主要功能：

### 1. 路径规划
- **驾车路径规划**：计算两点间最优驾车路线
- **步行路径规划**：规划步行路线，适合短距离出行
- **骑行路径规划**：提供自行车友好的路线
- **公交路径规划**：综合公交、地铁等公共交通方式
- **距离测量**：计算直线距离、驾车距离、步行距离

### 2. 批量行政区域查询
- 支持Excel文件批量处理
- 根据经纬度坐标查询详细地址信息
- 自动生成包含省份、城市、区县、详细地址的结果文件
- 提供Excel模板下载功能

### 3. 天气预报查询
- 实时天气信息查询
- 未来天气预报
- 生活指数（紫外线、穿衣、洗车、运动等）

### 4. 状态栏提示
- 实时显示程序运行状态
- 操作进度提示
- 错误信息反馈

## 使用方法

### 路径规划使用步骤

1. 打开"高德地图工具"选项卡
2. 切换到"路径规划"子选项卡
3. 输入起点经纬度（经度、纬度）
4. 输入终点经纬度（经度、纬度）
5. 点击"计算路径"按钮
6. 查看结果显示区域的详细路径信息

**示例坐标：**
- 起点：116.397428, 39.90923（天安门）
- 终点：116.3974, 39.9093（附近位置）

### 批量行政区域查询使用步骤

1. 切换到"批量行政区域查询"子选项卡
2. 点击"下载Excel模板"按钮，获取标准格式模板
3. 在模板中填入经纬度数据：
   - A列：经度
   - B列：纬度
4. 点击"上传Excel文件"选择填好的文件
5. 点击"开始查询"进行批量处理
6. 查看进度条和结果显示
7. 处理完成后，结果会自动保存为"原文件名_结果.xlsx"

**Excel模板格式：**
```
| 经度      | 纬度     | 省份 | 城市 | 区县 | 详细地址 |
|-----------|----------|------|------|------|----------|
| 116.39743 | 39.90923 |      |      |      |          |
```

### 天气预报查询使用步骤

1. 切换到"天气预报"子选项卡
2. 在"城市名称"输入框中输入要查询的城市
3. 点击"查询天气"按钮
4. 查看详细的天气信息，包括：
   - 实时天气状况
   - 温度、湿度、风力等
   - 今明两日天气预报
   - 生活指数建议

## 技术特性

### MCP服务器集成
- 本工具通过MCP（Model Context Protocol）服务器调用高德地图API
- 支持以下高德API接口：
  - `maps_direction_driving`：驾车路径规划
  - `maps_direction_walking`：步行路径规划
  - `maps_bicycling`：骑行路径规划
  - `maps_direction_transit_integrated`：公交路径规划
  - `maps_distance`：距离测量
  - `maps_regeocode`：逆地理编码
  - `maps_weather`：天气查询

### 多线程处理
- 所有API调用都在后台线程中执行
- 避免界面冻结，提供良好的用户体验
- 实时状态更新和进度显示

### 错误处理
- 完善的异常处理机制
- 用户友好的错误提示
- 网络异常自动重试

## 注意事项

1. **网络连接**：确保网络连接正常，API调用需要联网
2. **坐标格式**：经纬度请使用十进制格式（如：116.397428）
3. **文件格式**：批量查询仅支持.xlsx和.xls格式的Excel文件
4. **API限制**：请合理使用API，避免频繁调用
5. **数据准确性**：查询结果基于高德地图数据，请以实际情况为准

## 常见问题

**Q: 为什么路径规划没有结果？**
A: 请检查：
- 网络连接是否正常
- 经纬度格式是否正确
- 坐标是否在有效范围内

**Q: 批量查询进度很慢？**
A: 批量查询需要逐条调用API，处理大量数据时请耐心等待。建议单次处理不超过1000条记录。

**Q: Excel文件上传失败？**
A: 请确保：
- 文件格式为.xlsx或.xls
- 文件没有被其他程序占用
- A列为经度，B列为纬度

## 更新日志

### v1.0.0
- 初始版本发布
- 支持路径规划、批量地理编码、天气查询
- 集成MCP服务器调用
- 添加状态栏和进度显示

---

如有问题或建议，请联系开发团队。
# 文件工具集成平台

一个功能丰富的桌面工具集成平台，提供文件管理、图片处理、地理空间分析等多种实用工具。

## 🚀 功能特性
 
### 📁 系统文件处理工具集（统一界面）

**集成了文件路径获取、批量重命名、文件整理、时间分类等功能的完整解决方案：**

#### 📂 文件路径获取
- 快速获取文件和文件夹的完整路径
- 支持拖拽操作，便捷获取路径信息
- 自动复制到剪贴板功能

#### 🏷️ 文件批量重命名
- 支持多种命名规则和模板
- 预览重命名效果
- 批量处理大量文件
- 支持正则表达式和自定义规则

#### 🗂️ 文件智能整理
- 按文件类型自动分类整理
- 按日期规则组织文件结构
- 自定义整理规则
- 安全的文件移动和复制操作

#### ⏰ 文件时间分类
- 根据文件创建时间进行分类
- 根据文件修改时间进行整理
- 灵活的时间分组规则
- 批量时间属性处理

#### ⭐ 统一管理功能
- **选项卡设计**：所有文件处理功能在同一界面
- **统一状态栏**：实时显示操作进度和状态信息
- **一致主题**：统一的界面风格和用户体验
- **工作流整合**：从路径获取到文件整理的完整流程

### 🖼️ 图片处理工具集（统一界面）

**集成了图片GPS提取和图片处理功能的完整解决方案：**

#### 📍 GPS坐标提取
- 扫描文件夹中的图片，提取GPS坐标信息
- 支持导出Excel格式的GPS数据
- 批量重命名图片和文件夹功能
- 表格形式显示文件信息和坐标数据

#### 🎨 图片批量处理
- **基础处理**：尺寸调整、图片裁剪（顶部/底部）
- **高级处理**：随机旋转、图片压缩
- **格式转换**：支持多种图片格式转换
- **预览功能**：实时预览处理效果
- **批量操作**：支持大量图片的批量处理

#### ⭐ 统一管理功能
- **选项卡设计**：GPS提取和图片处理功能在同一界面
- **统一状态栏**：实时显示操作进度和状态信息
- **一致主题**：统一的界面风格和用户体验
- **工作流整合**：从GPS提取到图片处理的完整流程

### 📄 格式转换工具
- **Markdown ↔ Word转换**：支持Markdown文件与Word文档的双向转换
  - 🔤 保留标题层级结构（H1-H6）
  - 📝 支持粗体、斜体、行内代码等格式
  - 📊 支持表格转换
  - 📋 支持列表和引用块
  - 💻 支持代码块语法高亮
  - 👀 转换预览功能
  - ⚙️ 可配置转换选项

### 🗺️ 地理空间工具集（统一界面）

**集成了高德地图工具和地理空间分析工具的完整功能：**

#### 🔍 POI搜索
- 支持WGS-84坐标系输入
- 关键字和半径搜索
- 收藏位置快速选择
- 搜索结果导出（KML/Excel格式）

#### 🚗 路径规划
- 多种出行方式（驾车、步行、公交）
- WGS-84坐标输入支持
- 历史记录和收藏管理
- 详细路线信息显示

#### 📍 批量地理编码
- Excel文件批量处理
- WGS-84经纬度坐标查询
- 进度显示和结果导出
- 支持大量数据处理

#### 🌤️ 天气预报
- 城市名称或详细地址查询
- 常用城市快捷按钮
- 实时天气信息显示
- 天气数据导出功能

#### 🔄 格式转换
- **Excel ↔ KML互转**：支持地理数据格式转换
- **地址与经纬度批量转换**：通过高德API进行批量转换
- **KML点画圆**：在KML文件中为点位添加圆形区域
- **Excel模板下载**：提供标准格式模板

#### ⭐ 统一管理功能
- **收藏位置管理**：跨功能共享收藏位置
- **历史记录**：保存所有操作历史
- **配置管理**：统一的设置和API密钥管理
- **主题支持**：一致的界面主题

### 📊 Excel图片提取工具
- **图片提取**：从Excel文件中提取嵌入的图片
- **批量处理**：支持多个Excel文件的批量处理
- **格式保持**：保持原始图片格式和质量

### 🎯 最近点位匹配工具
- **距离计算**：计算两组坐标点之间的最短距离
- **批量匹配**：支持大量坐标点的批量匹配
- **结果导出**：支持匹配结果的导出功能
- **模板生成**：提供坐标数据模板生成功能

### ⚙️ 系统功能
- **主题管理**：支持多种界面主题
- **配置管理**：个性化设置和配置保存
- **历史记录**：操作历史记录和快速重用

## 🛠️ 技术栈

### 核心技术
- **Python 3.13**：主要开发语言
- **Tkinter**：图形用户界面框架
- **uv**：Python包管理和环境管理工具

### 主要依赖
- **数据处理**：pandas, numpy, openpyxl
- **图像处理**：opencv-python, pillow, piexif
- **地理空间**：geopy, requests（高德地图API）
- **文档处理**：python-docx, markdown, beautifulsoup4
- **可视化**：matplotlib
- **工具库**：pyperclip, send2trash, python-dotenv
- **打包部署**：pyinstaller

### 项目特点
- **模块化设计**：每个功能模块独立开发，便于维护和扩展
- **统一主题**：采用一致的UI设计风格
- **配置管理**：支持环境变量和用户配置文件
- **API集成**：集成高德地图Web服务API
- **跨平台**：基于Python和Tkinter，支持Windows、macOS、Linux

## 📦 安装与使用

### 环境要求
- **Python 3.13**（推荐使用最新版本）
- **Windows 11**（主要开发和测试环境）
- **uv**：Python包管理工具

### 安装步骤

1. **克隆项目**
   ```bash
   git clone [项目地址]
   cd IntegratedTools
   ```

2. **安装uv**（如果尚未安装）
   ```bash
   # Windows
   powershell -c "irm https://astral.sh/uv/install.ps1 | iex"
   ```

3. **安装项目依赖**
   ```bash
   # uv会自动创建虚拟环境并安装依赖
   uv sync
   ```

4. **配置环境变量**（可选但推荐）
   - 复制 `.env.template` 为 `.env`
   - 填入您的高德地图API密钥：
     ```
     AMAP_API_KEY=your_actual_api_key_here
     ```
   - 获取API密钥：[高德开放平台](https://console.amap.com/dev/key/app)

5. **运行程序**
   ```bash
   # 使用uv运行
   uv run python main.py
   
   # 或者使用提供的启动脚本（Windows）
   start.bat
   ```

### 快速开始

1. **启动程序**：双击 `start.bat` 或运行 `uv run python main.py`
2. **选择功能**：在主界面的选项卡中选择需要使用的工具
3. **配置设置**：首次使用地理空间工具时，请配置高德地图API密钥
4. **开始使用**：按照各工具界面的提示操作即可

### 功能模块说明

- **系统文件处理**：文件路径获取、批量重命名、文件整理、时间分类
- **最近点位匹配**：坐标点距离计算和匹配
- **图片处理工具集**：GPS坐标提取、图片批量处理
- **Excel图片提取**：从Excel文件中提取嵌入图片
- **地理空间工具集**：POI搜索、路径规划、地理编码、坐标转换、天气查询
- **格式转换工具**：文档、图片、视频、音频格式转换

## 📖 使用指南

### 系统文件处理工具集

#### 文件路径获取
1. 在"系统文件处理"选项卡中选择"📂 路径获取"子选项卡
2. 拖拽文件或文件夹到指定区域
3. 自动获取完整路径信息并复制到剪贴板

#### 文件批量重命名
1. 在"系统文件处理"选项卡中选择"🏷️ 批量重命名"子选项卡
2. 选择要重命名的文件夹
3. 设置重命名规则和模板
4. 预览重命名效果
5. 执行批量重命名操作

#### 文件智能整理
1. 在"系统文件处理"选项卡中选择"🗂️ 文件整理"子选项卡
2. 选择源文件夹和目标文件夹
3. 设置整理规则（按类型、日期等）
4. 执行智能整理操作

#### 文件时间分类
1. 在"系统文件处理"选项卡中选择"⏰ 时间分类"子选项卡
2. 选择要分类的文件夹
3. 设置时间分类规则（创建时间/修改时间）
4. 执行时间分类整理

### 图片处理工具集

#### GPS坐标提取
1. 在"图片处理工具集"选项卡中选择"📍 GPS提取"子选项卡
2. 选择包含图片的文件夹
3. 点击"扫描图片"按钮提取GPS信息
4. 查看表格中的坐标数据
5. 可导出Excel文件或进行批量重命名

#### 图片批量处理
1. 在"图片处理工具集"选项卡中选择"🖼️ 图片处理"子选项卡
2. 选择图片文件夹并加载图片
3. 在功能选项卡中设置处理参数：
   - **基础处理**：设置尺寸、裁剪参数
   - **高级处理**：设置旋转角度、压缩质量
   - **输出设置**：选择输出格式和保存位置
4. 预览处理效果
5. 执行批量处理

### 地理空间工具集

#### 首次使用配置
1. 启动应用后选择"地理空间工具集"选项卡
2. 如果是首次使用，系统会提示输入高德地图API密钥
3. 输入有效的API密钥后即可使用所有功能

#### POI搜索
1. 在"POI搜索"子选项卡中输入搜索坐标
2. 设置搜索关键字和半径
3. 点击搜索按钮获取结果
4. 可将结果导出为KML或Excel格式

#### 路径规划
1. 在"路径规划"子选项卡中设置起点和终点
2. 选择出行方式（驾车/步行/公交）
3. 点击规划按钮获取路线信息
4. 可保存常用路线到收藏

#### 批量地理编码
1. 在"批量地理编码"子选项卡中上传Excel文件
2. 确保Excel文件包含经纬度坐标列
3. 点击开始查询进行批量处理
4. 查看进度并下载结果文件

#### 天气查询
1. 在"天气预报"子选项卡中输入城市名或地址
2. 点击查询按钮获取天气信息
3. 可使用常用城市快捷按钮

#### 格式转换
1. 在"格式转换"子选项卡中选择转换类型
2. 上传相应格式的文件
3. 设置转换参数
4. 执行转换并下载结果

### 格式转换工具

#### Markdown转Word
1. 选择"格式转换"选项卡
2. 点击"选择Markdown文件"按钮
3. 选择要转换的.md文件
4. 可选择预览源文件内容
5. 点击"转换为Word"按钮
6. 选择保存位置完成转换

#### Word转Markdown
1. 选择"格式转换"选项卡
2. 点击"选择Word文件"按钮
3. 选择要转换的.docx文件
4. 可选择预览源文件内容
5. 点击"转换为Markdown"按钮
6. 选择保存位置完成转换

## 🔧 配置说明

### API密钥配置

#### 高德地图API（地理空间功能必需）
1. 访问 [高德开放平台](https://console.amap.com/dev/key/app)
2. 注册账号并创建应用
3. 获取Web服务API Key
4. 配置方式：
   - **环境变量**：在 `.env` 文件中设置 `AMAP_API_KEY`
   - **程序内配置**：在地理空间工具的配置管理中设置

### 配置文件说明

- **`config.py`**：全局配置管理类
- **`user_config.json`**：用户个人配置文件
- **`user_history.json`**：用户操作历史记录
- **`.env`**：环境变量配置文件

### 个人偏好设置

程序支持丰富的个人偏好设置：
- **界面设置**：主题、窗口大小、自动保存
- **收藏管理**：常用位置、常用城市
- **历史记录**：操作历史、搜索历史
- **缓存设置**：缓存开关、缓存时长、缓存大小
- **坐标转换**：默认坐标系、转换精度

### 项目配置

- **`pyproject.toml`**：项目依赖和元数据配置
- **`.python-version`**：指定Python版本（3.13）
- **`uv.lock`**：依赖版本锁定文件

## 📁 详细项目结构

```
IntegratedTools/
├── app/                          # 主应用程序模块
│   ├── __init__.py
│   ├── config.py                 # 应用配置管理
│   ├── integrated_tool.py        # 主应用程序类
│   ├── ui/                       # 用户界面模块
│   │   ├── __init__.py
│   │   ├── system_file_tool.py   # 系统文件处理工具主界面
│   │   ├── system_files/         # 系统文件处理子模块
│   │   │   ├── path_tab.py       # 文件路径获取
│   │   │   ├── rename_tab.py     # 批量重命名
│   │   │   ├── organizer_tab.py  # 文件整理
│   │   │   └── sorter_tab.py     # 时间分类
│   │   ├── image_processor_tool.py # 图片处理工具主界面
│   │   ├── image_processor/      # 图片处理子模块
│   │   │   ├── gps_extractor_tab.py # GPS提取
│   │   │   └── processor_tab.py  # 图片处理
│   │   ├── geospatial_tool.py    # 地理空间工具主界面
│   │   ├── geospatial/           # 地理空间子模块
│   │   │   ├── poi_search_tab.py # POI搜索
│   │   │   ├── route_tab.py      # 路径规划
│   │   │   ├── geocoding_tab.py  # 地理编码
│   │   │   ├── conversion_tab.py # 坐标转换
│   │   │   └── weather_tab.py    # 天气查询
│   │   ├── format_converter_tool.py # 格式转换工具主界面
│   │   ├── format_converter/     # 格式转换子模块
│   │   │   ├── converter_tab.py  # 文档转换
│   │   │   ├── image_converter_tab.py # 图片转换
│   │   │   ├── video_converter_tab.py # 视频转换
│   │   │   └── audio_converter_tab.py # 音频转换
│   │   ├── point_matcher_tool.py # 点位匹配工具
│   │   ├── point_matcher/        # 点位匹配子模块
│   │   ├── excel_image_extractor_tool.py # Excel图片提取工具
│   │   └── excel_image_extractor/ # Excel图片提取子模块
│   └── utils/                    # 工具类和辅助功能
│       ├── __init__.py
│       ├── amap_api.py           # 高德地图API接口
│       ├── coordinate_converter.py # 坐标转换工具
│       ├── file_operations.py    # 文件操作工具
│       ├── history_manager.py    # 历史记录管理
│       └── theme.py              # 主题管理
├── config.py                     # 全局配置类
├── main.py                       # 程序启动入口
├── pyproject.toml               # 项目配置和依赖
├── uv.lock                      # 依赖版本锁定
├── .python-version              # Python版本指定
├── start.bat                    # Windows启动脚本
├── .env.template                # 环境变量模板
├── .gitignore                   # Git忽略文件
├── user_config.json             # 用户配置文件
├── user_history.json            # 用户历史记录
└── README.md                    # 项目说明文档
```

## 🚀 部署和打包

### 开发环境运行
```bash
# 使用uv运行（推荐）
uv run python main.py

# 或使用启动脚本
start.bat
```

### 打包为可执行文件
项目已配置PyInstaller，可以打包为独立的可执行文件：

```bash
# 安装打包依赖
uv add pyinstaller

# 打包（如果有spec文件）
uv run pyinstaller IntegratedTools.spec

# 或者直接打包
uv run pyinstaller --onefile --windowed main.py
```

## 🔍 故障排除

### 常见问题

1. **高德地图API不可用**
   - 检查网络连接
   - 确认API密钥配置正确
   - 验证API密钥是否有效且有足够配额

2. **依赖安装失败**
   - 确保使用Python 3.13
   - 尝试更新uv：`uv self update`
   - 清除缓存：`uv cache clean`

3. **界面显示异常**
   - 检查系统DPI设置
   - 确保Tkinter正确安装
   - 尝试重置用户配置文件

### 日志和调试
- 程序运行时的错误信息会显示在控制台
- 用户配置和历史记录保存在JSON文件中
- 可以通过删除配置文件来重置程序设置

## 🚀 新功能特性

### 图片处理工具集统一界面

#### ✨ 功能整合优势
- **统一界面**：GPS提取和图片处理功能集成在一个界面中
- **工作流整合**：从GPS提取到图片处理的完整流程
- **一致体验**：统一的主题、操作逻辑和界面设计
- **高效切换**：通过选项卡快速切换不同功能
- **模块化设计**：所有功能模块整合在image_processor文件夹中，便于维护

#### 🔧 技术改进
- **代码复用**：消除了重复代码，提高维护效率
- **资源优化**：统一的状态管理和配置系统
- **扩展性强**：新功能可轻松集成到现有框架

### 地理空间工具集统一界面

#### ✨ 功能整合优势
- **统一界面**：所有地理空间功能集成在一个界面中
- **共享资源**：收藏位置、历史记录、配置在所有功能间共享
- **一致体验**：统一的主题、操作逻辑和界面设计
- **高效切换**：通过选项卡快速切换不同功能
- **模块化设计**：所有功能模块整合在geospatial文件夹中，便于维护

#### 🔧 技术改进
- **代码复用**：消除了重复代码，提高维护效率
- **资源优化**：统一的API管理和配置系统
- **扩展性强**：新功能可轻松集成到现有框架
- **文件结构优化**：原amap和geospatial模块完全整合

### 格式转换工具增强功能

#### ✨ 增强的Markdown支持
- **表格转换**：完整支持Markdown表格语法
- **代码块**：支持语法高亮的代码块转换
- **行内格式**：粗体、斜体、行内代码的精确转换
- **链接处理**：自动识别和转换超链接
- **引用块**：支持多级引用块转换

#### 📝 Word文档处理优化
- **格式保留**：保持原文档的字体样式和格式
- **表格支持**：完整的表格结构转换
- **样式识别**：自动识别标题、列表、引用等样式
- **字体设置**：自动设置中文友好字体（微软雅黑）
- **段落格式**：保持段落缩进和对齐方式

#### 👀 转换预览功能
- **实时预览**：转换前预览源文件内容
- **内容截取**：大文件智能截取显示
- **格式检查**：转换前验证文件格式
- **错误提示**：详细的错误信息和解决建议

## ## 🤝 贡献指南

欢迎贡献代码！请遵循以下步骤：

1. Fork 本项目
2. 创建特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 开启 Pull Request

### 代码规范
- 遵循 PEP 8 Python 代码规范
- 使用中文注释和文档字符串
- 保持模块化设计原则
- 确保新功能有相应的错误处理

### 开发环境设置
```bash
# 克隆项目
git clone [项目地址]
cd IntegratedTools

# 安装开发依赖
uv sync --dev

# 运行测试
uv run python -m pytest
```

## 📄 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情

## 📞 联系方式

如有问题或建议，请通过以下方式联系：
- 提交 GitHub Issue
- 发送邮件至 [your-email@example.com]

## 🙏 致谢

- 感谢高德地图提供的地理空间API服务
- 感谢所有开源库的贡献者
- 感谢所有为本项目做出贡献的开发者和用户

---

**注意**：
- 本工具仅供学习和个人使用
- 请遵守相关法律法规和API使用条款
- 使用高德地图API需要遵守其服务条款
- 建议在生产环境使用前进行充分测试

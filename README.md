# 文件工具集成平台

一个功能丰富的桌面工具集成平台，提供文件管理、图片处理、地理空间分析等多种实用工具。

## 🚀 功能特性
 
### 📁 系统文件处理工具集（统一界面）

**集成了文件路径获取、批量重命名、文件整理、时间分类等功能的完整解决方案：**

#### 📂 文件路径获取
- 快速获取文件和文件夹的完整路径
- 支持拖拽操作，便捷获取路径信息
- 自动复制到剪贴板功能

#### 🏷️ 文件批量重命名
- 支持多种命名规则和模板
- 预览重命名效果
- 批量处理大量文件
- 支持正则表达式和自定义规则

#### 🗂️ 文件智能整理
- 按文件类型自动分类整理
- 按日期规则组织文件结构
- 自定义整理规则
- 安全的文件移动和复制操作

#### ⏰ 文件时间分类
- 根据文件创建时间进行分类
- 根据文件修改时间进行整理
- 灵活的时间分组规则
- 批量时间属性处理

#### ⭐ 统一管理功能
- **选项卡设计**：所有文件处理功能在同一界面
- **统一状态栏**：实时显示操作进度和状态信息
- **一致主题**：统一的界面风格和用户体验
- **工作流整合**：从路径获取到文件整理的完整流程

### 🖼️ 图片处理工具集（统一界面）

**集成了图片GPS提取和图片处理功能的完整解决方案：**

#### 📍 GPS坐标提取
- 扫描文件夹中的图片，提取GPS坐标信息
- 支持导出Excel格式的GPS数据
- 批量重命名图片和文件夹功能
- 表格形式显示文件信息和坐标数据

#### 🎨 图片批量处理
- **基础处理**：尺寸调整、图片裁剪（顶部/底部）
- **高级处理**：随机旋转、图片压缩
- **格式转换**：支持多种图片格式转换
- **预览功能**：实时预览处理效果
- **批量操作**：支持大量图片的批量处理

#### ⭐ 统一管理功能
- **选项卡设计**：GPS提取和图片处理功能在同一界面
- **统一状态栏**：实时显示操作进度和状态信息
- **一致主题**：统一的界面风格和用户体验
- **工作流整合**：从GPS提取到图片处理的完整流程

### 🎥 视频处理工具
- **视频压缩**：高效的视频文件压缩和格式转换

### 📄 格式转换工具
- **Markdown ↔ Word转换**：支持Markdown文件与Word文档的双向转换
  - 🔤 保留标题层级结构（H1-H6）
  - 📝 支持粗体、斜体、行内代码等格式
  - 📊 支持表格转换
  - 📋 支持列表和引用块
  - 💻 支持代码块语法高亮
  - 👀 转换预览功能
  - ⚙️ 可配置转换选项

### 🗺️ 地理空间工具集（统一界面）

**集成了高德地图工具和地理空间分析工具的完整功能：**

#### 🔍 POI搜索
- 支持WGS-84坐标系输入
- 关键字和半径搜索
- 收藏位置快速选择
- 搜索结果导出（KML/Excel格式）

#### 🚗 路径规划
- 多种出行方式（驾车、步行、公交）
- WGS-84坐标输入支持
- 历史记录和收藏管理
- 详细路线信息显示

#### 📍 批量地理编码
- Excel文件批量处理
- WGS-84经纬度坐标查询
- 进度显示和结果导出
- 支持大量数据处理

#### 🌤️ 天气预报
- 城市名称或详细地址查询
- 常用城市快捷按钮
- 实时天气信息显示

#### 🔄 格式转换
- **Excel ↔ KML互转**：支持地理数据格式转换
- **地址与经纬度批量转换**：通过高德API进行批量转换
- **KML点画圆**：在KML文件中为点位添加圆形区域
- **Excel模板下载**：提供标准格式模板

#### ⭐ 统一管理功能
- **收藏位置管理**：跨功能共享收藏位置
- **历史记录**：保存所有操作历史
- **配置管理**：统一的设置和API密钥管理
- **主题支持**：一致的界面主题

### 📊 Excel图片提取
- 从Excel文件中批量提取图片

### 📍 最近点位匹配
- 地理位置点位匹配分析
- 距离计算和最优匹配

### ⚙️ 系统功能
- **主题管理**：支持多种界面主题
- **配置管理**：个性化设置和配置保存
- **历史记录**：操作历史记录和快速重用

## 📦 安装和使用

### 前置要求

- **Python 3.8+**
- **uv包管理器** - [安装指南](https://docs.astral.sh/uv/getting-started/installation/)
- **高德地图API密钥**（仅地图功能需要） - [申请地址](https://console.amap.com/dev/key/app)

#### 格式转换功能依赖
- **python-docx** - Word文档处理
- **markdown** - Markdown解析和转换
- **beautifulsoup4** - HTML解析
- **re** - 正则表达式处理（Python内置）

### 快速开始

1. **克隆或下载项目**
   ```bash
   git clone <repository-url>
   cd Integrated_Tools
   ```

2. **使用快速启动脚本（推荐）**
   ```bash
   # Windows
   start.bat
   ```
   
   或手动启动：
   ```bash
   # 创建虚拟环境并安装依赖
   uv sync
   
   # 启动应用
   uv run python main.py
   ```

3. **配置API密钥**（可选）
   - 如需使用地理空间工具的高德地图功能，首次启动时会提示输入API密钥
   - 其他工具无需额外配置即可使用

## 📖 使用指南

### 系统文件处理工具集

#### 文件路径获取
1. 在"系统文件处理"选项卡中选择"📂 路径获取"子选项卡
2. 拖拽文件或文件夹到指定区域
3. 自动获取完整路径信息并复制到剪贴板

#### 文件批量重命名
1. 在"系统文件处理"选项卡中选择"🏷️ 批量重命名"子选项卡
2. 选择要重命名的文件夹
3. 设置重命名规则和模板
4. 预览重命名效果
5. 执行批量重命名操作

#### 文件智能整理
1. 在"系统文件处理"选项卡中选择"🗂️ 文件整理"子选项卡
2. 选择源文件夹和目标文件夹
3. 设置整理规则（按类型、日期等）
4. 执行智能整理操作

#### 文件时间分类
1. 在"系统文件处理"选项卡中选择"⏰ 时间分类"子选项卡
2. 选择要分类的文件夹
3. 设置时间分类规则（创建时间/修改时间）
4. 执行时间分类整理

### 图片处理工具集

#### GPS坐标提取
1. 在"图片处理工具集"选项卡中选择"📍 GPS提取"子选项卡
2. 选择包含图片的文件夹
3. 点击"扫描图片"按钮提取GPS信息
4. 查看表格中的坐标数据
5. 可导出Excel文件或进行批量重命名

#### 图片批量处理
1. 在"图片处理工具集"选项卡中选择"🖼️ 图片处理"子选项卡
2. 选择图片文件夹并加载图片
3. 在功能选项卡中设置处理参数：
   - **基础处理**：设置尺寸、裁剪参数
   - **高级处理**：设置旋转角度、压缩质量
   - **输出设置**：选择输出格式和保存位置
4. 预览处理效果
5. 执行批量处理

### 地理空间工具集

#### 首次使用配置
1. 启动应用后选择"地理空间工具集"选项卡
2. 如果是首次使用，系统会提示输入高德地图API密钥
3. 输入有效的API密钥后即可使用所有功能

#### POI搜索
1. 在"POI搜索"子选项卡中输入搜索坐标
2. 设置搜索关键字和半径
3. 点击搜索按钮获取结果
4. 可将结果导出为KML或Excel格式

#### 路径规划
1. 在"路径规划"子选项卡中设置起点和终点
2. 选择出行方式（驾车/步行/公交）
3. 点击规划按钮获取路线信息
4. 可保存常用路线到收藏

#### 批量地理编码
1. 在"批量地理编码"子选项卡中上传Excel文件
2. 确保Excel文件包含经纬度坐标列
3. 点击开始查询进行批量处理
4. 查看进度并下载结果文件

#### 天气查询
1. 在"天气预报"子选项卡中输入城市名或地址
2. 点击查询按钮获取天气信息
3. 可使用常用城市快捷按钮

#### 格式转换
1. 在"格式转换"子选项卡中选择转换类型
2. 上传相应格式的文件
3. 设置转换参数
4. 执行转换并下载结果

### 格式转换工具

#### Markdown转Word
1. 选择"格式转换"选项卡
2. 点击"选择Markdown文件"按钮
3. 选择要转换的.md文件
4. 可选择预览源文件内容
5. 点击"转换为Word"按钮
6. 选择保存位置完成转换

#### Word转Markdown
1. 选择"格式转换"选项卡
2. 点击"选择Word文件"按钮
3. 选择要转换的.docx文件
4. 可选择预览源文件内容
5. 点击"转换为Markdown"按钮
6. 选择保存位置完成转换

## 📁 项目结构

```
Integrated_Tools/
├── app/
│   ├── __init__.py
│   ├── integrated_tool.py          # 主应用集成类
│   ├── ui/                         # 用户界面模块
│   │   ├── __init__.py
│   │   ├── geospatial_tool.py      # 统一的地理空间工具集
│   │   ├── geospatial/             # 地理空间工具模块（整合了原amap和geospatial功能）
│   │   │   ├── __init__.py
│   │   │   ├── amap_api.py         # 高德地图API接口
│   │   │   ├── conversion_tab.py   # 格式转换界面
│   │   │   ├── coordinate_utils.py # 坐标工具
│   │   │   ├── dialogs.py          # 配置对话框（包含ConfigDialog和ApiKeyDialog）
│   │   │   ├── geocoding_tab.py    # 地理编码界面
│   │   │   ├── kml_utils.py        # KML工具
│   │   │   ├── poi_search_tab.py   # POI搜索界面
│   │   │   ├── route_tab.py        # 路径规划界面
│   │   │   ├── utils.py            # 工具函数
│   │   │   └── weather_tab.py      # 天气查询界面
│   │   ├── image_processor_tool.py # 统一的图片处理工具集
│   │   ├── image_processor/        # 图片处理工具模块（整合了原GPS提取和图片处理功能）
│   │   │   ├── __init__.py
│   │   │   ├── processor_tab.py    # 图片处理界面
│   │   │   └── gps_extractor_tab.py # GPS提取界面
│   │   ├── file_path/              # 文件路径工具模块
│   │   │   └── path_tab.py         # 路径获取界面
│   │   ├── rename/                 # 重命名工具模块
│   │   │   ├── rename_tab.py       # 重命名界面
│   │   │   └── template_generator.py # 模板生成器
│   │   ├── file_organizer/         # 文件整理工具模块
│   │   │   └── organizer_tab.py    # 整理界面
│   │   ├── file_sorter/            # 文件分类工具模块
│   │   │   └── sorter_tab.py       # 分类界面
│   │   ├── video_resizer/          # 视频压缩工具模块
│   │   │   └── feature_tab.py      # 功能界面
│   │   ├── excel_image_extractor/  # Excel图片提取模块
│   │   │   └── extractor_tab.py    # 提取界面
│   │   ├── format_converter/       # 格式转换工具模块
│   │   │   └── converter_tab.py    # 转换界面
│   │   ├── point_matcher/          # 点位匹配工具模块
│   │   │   ├── point_matcher_tab.py # 匹配界面
│   │   │   ├── distance_calculator.py # 距离计算
│   │   │   └── template_generator.py # 模板生成器
│   │   ├── file_path_tool.py       # 文件路径工具主类
│   │   ├── rename_tool.py          # 重命名工具主类
│   │   ├── file_organizer_tool.py  # 文件整理工具主类
│   │   ├── file_sorter_tool.py     # 文件分类工具主类
│   │   ├── video_resizer_tool.py   # 视频压缩工具主类
│   │   ├── excel_image_extractor_tool.py # Excel图片提取主类
│   │   ├── format_converter_tool.py # 格式转换工具主类
│   │   └── point_matcher_tool.py   # 点位匹配工具主类
│   └── utils/                      # 工具库
│       ├── amap_api.py             # 高德地图API
│       ├── coordinate_converter.py  # 坐标转换
│       ├── file_operations.py      # 文件操作
│       ├── history_manager.py      # 历史管理
│       └── theme.py                # 主题管理
├── config.py                       # 配置管理
├── main.py                         # 应用入口
├── pyproject.toml                  # 项目配置（uv包管理）
├── uv.lock                         # uv锁定文件
├── start.bat                       # 启动脚本
├── user_config.json              # 用户配置
├── user_history.json              # 用户历史
└── README.md                       # 说明文档
```

## 🔧 配置文件

应用会自动创建以下配置文件：

- `user_config.json` - 用户个人配置
- `user_history.json` - 操作历史记录
- `config.py` - 应用配置管理

## 🚀 新功能特性

### 图片处理工具集统一界面

#### ✨ 功能整合优势
- **统一界面**：GPS提取和图片处理功能集成在一个界面中
- **工作流整合**：从GPS提取到图片处理的完整流程
- **一致体验**：统一的主题、操作逻辑和界面设计
- **高效切换**：通过选项卡快速切换不同功能
- **模块化设计**：所有功能模块整合在image_processor文件夹中，便于维护

#### 🔧 技术改进
- **代码复用**：消除了重复代码，提高维护效率
- **资源优化**：统一的状态管理和配置系统
- **扩展性强**：新功能可轻松集成到现有框架

### 地理空间工具集统一界面

#### ✨ 功能整合优势
- **统一界面**：所有地理空间功能集成在一个界面中
- **共享资源**：收藏位置、历史记录、配置在所有功能间共享
- **一致体验**：统一的主题、操作逻辑和界面设计
- **高效切换**：通过选项卡快速切换不同功能
- **模块化设计**：所有功能模块整合在geospatial文件夹中，便于维护

#### 🔧 技术改进
- **代码复用**：消除了重复代码，提高维护效率
- **资源优化**：统一的API管理和配置系统
- **扩展性强**：新功能可轻松集成到现有框架
- **文件结构优化**：原amap和geospatial模块完全整合

### 格式转换工具增强功能

#### ✨ 增强的Markdown支持
- **表格转换**：完整支持Markdown表格语法
- **代码块**：支持语法高亮的代码块转换
- **行内格式**：粗体、斜体、行内代码的精确转换
- **链接处理**：自动识别和转换超链接
- **引用块**：支持多级引用块转换

#### 📝 Word文档处理优化
- **格式保留**：保持原文档的字体样式和格式
- **表格支持**：完整的表格结构转换
- **样式识别**：自动识别标题、列表、引用等样式
- **字体设置**：自动设置中文友好字体（微软雅黑）
- **段落格式**：保持段落缩进和对齐方式

#### 👀 转换预览功能
- **实时预览**：转换前预览源文件内容
- **内容截取**：大文件智能截取显示
- **格式检查**：转换前验证文件格式
- **错误提示**：详细的错误信息和解决建议

## ⚙️ 环境配置

### 🔐 API密钥配置

为了保护敏感信息，本项目使用环境变量管理API密钥：

1. **复制环境变量模板**：
   ```bash
   cp .env.template .env
   ```

2. **编辑 `.env` 文件**，填入你的API密钥：
   ```bash
   # 高德地图API密钥
   AMAP_API_KEY=your_actual_api_key_here
   ```

3. **安装依赖**：
   ```bash
   uv sync
   ```

### 🔑 API密钥申请（高德地图功能）

1. 访问[高德开放平台](https://console.amap.com/dev/key/app)
2. 注册并登录账号
3. 创建新应用
4. 申请"Web服务API"密钥
5. 将密钥配置到 `.env` 文件中

### 📋 配置文件说明

- `.env` - 环境变量配置（包含敏感信息，不会提交到仓库）
- `.env.template` - 环境变量模板（可安全提交）
- `user_config.json` - 用户偏好设置（不包含敏感信息）

### 🛡️ 安全说明

- `.env` 文件已添加到 `.gitignore`，不会被提交到版本控制
- API密钥优先从环境变量读取，确保安全性
- 配置文件中的敏感信息已被移除

---

**注意**：使用地理空间工具集的高德地图相关功能需要有效的API密钥。其他工具可以独立使用，无需额外配置。
